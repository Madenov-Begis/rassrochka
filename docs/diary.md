/**
 * @file: diary.md
 * @description: Дневник решений, наблюдений, багов
 * @dependencies: -
 * @created: 2024-07-02
 */

## [2024-07-02]
- Принято решение: строго следовать модульности backend и общей структуре frontend.
- Вся документация будет обновляться при каждом изменении архитектуры или логики.

## [2025-07-04] Итог по админке
- Завершена реализация и тестирование всех функций админки
- Все баги устранены, UX и валидация соответствуют ТЗ
- Документация синхронизирована
- Готово к переходу к следующим разделам 

### 2025-07-03
Проблема: на детальной странице клиента отображались рассрочки других клиентов. Причина — общий endpoint возвращал все рассрочки магазина, фильтрация по customerId не работала. Решение: добавлен отдельный endpoint `/api/client/customers/:id/installments`, фронт переведён на него. Теперь отображаются только рассрочки выбранного клиента. 

### 2025-07-04
Реализовано: глобальный поиск по паспорту теперь возвращает только магазины, где клиент в чёрном списке или с просрочкой. На фронте результат отображается карточками с деталями, статусами и списком просрочек.

Принято решение отказаться от таблицы Blacklist. Теперь блокировка клиента реализуется только через флаг isBlacklisted в таблице клиентов. Удалена вся связанная логика и формы. 

## [2025-07-05] Массовое преобразование id к number
- Принято решение: во всех контроллерах backend преобразовывать id и внешние ключи из params/query/body к типу number (Number(id)) перед передачей в сервисы.
- Причина: Prisma и база ожидают Int, а параметры из URL всегда string. Это устраняет ошибки типов и повышает надёжность.
- Решение зафиксировано в project.md, changelog.md, tasktracker.md. 

## [2025-07-05] Итог по приведению id к number
- Все контроллеры backend теперь преобразуют id и внешние ключи из params/query/body к типу number (Number(id)) перед передачей в сервисы.
- Проведено тестирование: все endpoints работают корректно, ошибки типов устранены.
- Документация и changelog синхронизированы.
- Решение повышает надёжность и предотвращает ошибки при работе с Prisma и строгой типизацией. 